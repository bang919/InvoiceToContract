# Word模板变量标记指南

## 基本原则

1. 在Word中，变量标记使用`{{变量名}}`格式
2. 确保变量名与代码中提供的数据字段名完全匹配（包括大小写）
3. 保持变量标记为纯文本格式，不要应用特殊格式（如粗体、斜体等）

## 步骤说明

### 1. 打开您的合同模板

1. 使用Microsoft Word打开`合同模版.docx`文件
2. 备份原始文件（重要！）

### 2. 替换静态文本为变量标记

寻找需要动态替换的文本，例如：

- 找到"河南萌堡建筑工程有限公司"，替换为`{{buyerName}}`
- 找到"漯河锦星建材有限公司"，替换为`{{sellerName}}`
- 找到公司税号，替换为`{{buyerTaxID}}`和`{{sellerTaxID}}`
- 找到项目名称，替换为`{{projectName}}`
- 找到合同金额，替换为`{{totalAmount}}`元
- 找到金额大写，替换为`{{amountInWords}}`

### 3. 处理表格（最重要）

表格处理是最复杂的部分，需要特别注意：

1. **不要修改表格结构**（不添加或删除行列）
2. **只在表格的一行中**添加循环标记
3. 使用以下格式（必须在同一行内）：

```
{{#each tableData}}这里放单元格内容{{/each}}
```

例如，在表格中可以这样标记：

```
第一单元格：{{#each tableData}}{{index}}
第二单元格：{{name}}
第三单元格：{{spec}}
第四单元格：{{quantity}}
第五单元格：{{unit}}
第六单元格：{{price}}
第七单元格：{{amount}}{{/each}}
```

### 4. 可用的变量名列表

基本信息：
- `{{buyerName}}` - 买方名称
- `{{sellerName}}` - 卖方名称
- `{{buyerTaxID}}` - 买方税号
- `{{sellerTaxID}}` - 卖方税号
- `{{projectName}}` - 项目名称
- `{{projectAddress}}` - 项目地址

银行信息：
- `{{buyerBank}}` - 买方银行
- `{{buyerBankAccount}}` - 买方账号
- `{{sellerBank}}` - 卖方银行
- `{{sellerBankAccount}}` - 卖方账号

日期和编号：
- `{{contractDate}}` - 合同日期
- `{{contractNo}}` - 合同编号

金额信息：
- `{{totalAmount}}` - 合同总金额
- `{{amountInWords}}` - 大写金额

表格数据（在循环内使用）：
- `{{index}}` - 序号
- `{{name}}` - 名称
- `{{spec}}` - 规格
- `{{unit}}` - 单位
- `{{quantity}}` - 数量
- `{{price}}` - 单价
- `{{amount}}` - 金额

### 5. 保存文件

1. 使用"另存为"保存为`.docx`格式（不要使用.doc）
2. 将文件保存到`public/templates/`目录
3. 更新代码中的模板路径

## 常见问题与解决方法

1. **变量不替换**：确保变量名完全匹配，包括大小写
2. **格式问题**：尝试移除变量标记的所有格式，重新输入纯文本
3. **表格循环失败**：确保循环标记在同一行内，不跨行
4. **文件格式**：确保使用.docx格式，不是.doc

## 示例模板

请参考`example-template.txt`作为参考，了解正确的变量标记方式。
将此文本内容复制到Word中，保存为.docx格式，可以作为测试模板。 